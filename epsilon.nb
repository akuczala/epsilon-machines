(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     86163,       1718]
NotebookOptionsPosition[     82813,       1656]
NotebookOutlinePosition[     83179,       1672]
CellTagsIndexPosition[     83136,       1669]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
Calculate equivalence classes of list, and return indices grouped by \
equivalence class\
\>", "Text",
 CellChangeTimes->{{3.7926236014733143`*^9, 
  3.7926236672781878`*^9}},ExpressionUUID->"ec887f50-17c0-4051-bd92-\
60c2b254ec9a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EquivalenceIndices", "[", 
    RowBox[{"list_", ",", "f_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"matchingPairs", ",", "graph", ",", "components"}], "}"}], ",", 
     RowBox[{
      RowBox[{"matchingPairs", " ", "=", " ", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Tuples", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "list", "]"}], "]"}], ",", "2"}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"list", "\[LeftDoubleBracket]", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{"list", "\[LeftDoubleBracket]", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "\[RightDoubleBracket]"}]}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"graph", " ", "=", " ", 
       RowBox[{"Graph", "[", 
        RowBox[{"Apply", "[", 
         RowBox[{"UndirectedEdge", ",", "matchingPairs", ",", 
          RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ConnectedComponents", "[", "graph", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.792370709335971*^9, 3.792370709470759*^9}, {
  3.792623672535932*^9, 
  3.792623686239532*^9}},ExpressionUUID->"fa58c9c7-de43-4f06-b7bd-\
688c413392c8"],

Cell[CellGroupData[{

Cell["Example sequences", "Subsection",
 CellChangeTimes->{{3.792623733668667*^9, 
  3.792623735819594*^9}},ExpressionUUID->"9361d4af-57fc-4801-8014-\
e4ee4f6a5452"],

Cell[BoxData[
 RowBox[{
  RowBox[{"genSeq", "=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"RandomChoice", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\"\<112\>\"", ",", "\"\<102\>\"", ",", "\"\<012\>\"", ",", 
        "\"\<002\>\""}], "}"}], ",", "8000"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.694496511971977*^9, 3.694496618874946*^9}, {
   3.6944967316797066`*^9, 3.6944968121737924`*^9}, {3.6945476507365065`*^9, 
   3.6945476514000006`*^9}, {3.6945488302287207`*^9, 3.694548831779799*^9}, {
   3.6945536229040236`*^9, 3.694553626901886*^9}, {3.6945539306914244`*^9, 
   3.69455393193629*^9}, {3.694555341356216*^9, 3.6945553416348176`*^9}, {
   3.6945558735707917`*^9, 3.694555875433731*^9}, {3.6945559829912043`*^9, 
   3.6945559866838307`*^9}, {3.6945561588592157`*^9, 
   3.6945562227493196`*^9}, {3.69455644934017*^9, 3.694556471156519*^9}, {
   3.694556504537411*^9, 3.694556516902452*^9}, {3.6945565823180013`*^9, 
   3.6945566055601854`*^9}, {3.6945566637288246`*^9, 
   3.6945566801265144`*^9}, {3.6945567194731584`*^9, 3.694556840276365*^9}, {
   3.6945571034475985`*^9, 3.6945571280806365`*^9}, {3.694557165805546*^9, 
   3.6945571761266623`*^9}, {3.6945572999100103`*^9, 
   3.6945573407853036`*^9}, {3.694557420100497*^9, 3.694557464647727*^9}, {
   3.694557510104204*^9, 3.6945575198140144`*^9}, {3.694557607690965*^9, 
   3.6945576257848296`*^9}, {3.6945576628850465`*^9, 
   3.6945576629270763`*^9}, {3.6945577636941357`*^9, 
   3.6945577775794754`*^9}, {3.694557869492686*^9, 3.694557869773885*^9}, {
   3.6945580049868813`*^9, 3.694558005075917*^9}, {3.6945581981621275`*^9, 
   3.694558237244483*^9}, {3.694558267467605*^9, 3.694558272515401*^9}, {
   3.6945584818424253`*^9, 3.69455848394392*^9}, {3.694558545080866*^9, 
   3.694558545977482*^9}, {3.6945590247208004`*^9, 3.6945590434075155`*^9}, {
   3.694559122732386*^9, 3.6945591242714777`*^9}, {3.694559166071825*^9, 
   3.694559196736457*^9}, {3.6945593269390326`*^9, 3.6945593272132473`*^9}, {
   3.792623771657174*^9, 3.7926237719359922`*^9}, {3.792629554845332*^9, 
   3.79262956549658*^9}, 3.7926296098770647`*^9},
 CellLabel->
  "In[2262]:=",ExpressionUUID->"29f80a4b-8587-4ea5-be22-cc8d2fb1c6b4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"seqGen", "[", 
   RowBox[{"{", 
    RowBox[{"a_", ",", "b_"}], "}"}], "]"}], " ", ":=", " ", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Mod", "[", 
      RowBox[{
       RowBox[{"a", " ", "+", "b"}], ",", "2"}], "]"}], ",", 
     RowBox[{"Mod", "[", 
      RowBox[{
       RowBox[{"a", "+", "b", "+", "1"}], ",", "2"}], "]"}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"seqLen", " ", "=", " ", "2000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"init", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"genSeq", "=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"ToString", "/@", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"NestList", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
            RowBox[{"seqGen", "[", "#", "]"}]}], "}"}], "&"}], ",", "init", 
         ",", "seqLen"}], "]"}], "]"}], "\[LeftDoubleBracket]", "1", 
      "\[RightDoubleBracket]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6945490166479874`*^9, 3.6945490768688107`*^9}, {
  3.694549979187866*^9, 3.694549981497509*^9}, {3.694550291351593*^9, 
  3.6945503938831615`*^9}, {3.6945509157121167`*^9, 3.6945509163555746`*^9}, {
  3.6945511339473743`*^9, 3.6945511371686525`*^9}, {3.694553319185534*^9, 
  3.694553327356344*^9}, {3.6945534355817184`*^9, 3.694553512948741*^9}, {
  3.694556949414194*^9, 3.6945569926640577`*^9}, {3.694557031900713*^9, 
  3.694557063671764*^9}, {3.792623776881505*^9, 3.792623777685152*^9}},
 CellLabel->
  "In[2263]:=",ExpressionUUID->"87404ed6-3725-4748-a9b3-0e9e2b931436"],

Cell["Generate binary sequence from binning the logistic map", "Text",
 CellChangeTimes->{{3.792623804634324*^9, 
  3.792623813220345*^9}},ExpressionUUID->"9ad225d1-6d6d-4765-a5ed-\
3c06e3993a61"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"logistic", "[", 
    RowBox[{"x_", ",", "r_"}], "]"}], " ", ":=", " ", 
   RowBox[{"r", " ", "x", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", "x"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"seqLen", " ", "=", " ", "6000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"genSeq", "=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"#", ">", "0.5"}], ",", "\"\<1\>\"", ",", "\"\<0\>\""}], 
       "]"}], "&"}], "/@", 
     RowBox[{"NestList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"logistic", "[", 
         RowBox[{"#", ",", "3.6"}], "]"}], "&"}], ",", "0.6", ",", "seqLen"}],
       "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQfXbb4lU32l47KtQ7rQbRHgE8G0B0yxZNMF2WxLYN
RL/8K74LRJvwsR4A0X5TVoDpkq+P/oDo6c63GW8C6b49PGwgmmvZP34Q3TxH
UwREJ0jtFwPROnM0tEC00uR1OiBacDGnGYi2ENpkAaJ9dN67guhTx3w8QfSB
DTPDQfTq1wlRIHq3sUoniNZbZQKm3YyTJ4Do6Ok8E0G0QtxtoyTHN47ngh6A
6YRnxc4gelpnOZhep+gXCqIX/A0E0yHpewtBtGqLUwmIzqhsnn8XSP/41Qum
+cRU1oLoLm1DMG22acMZEF1uI3MWRL+yFngCoj/8sQDTAOS7saM=
  "],
 CellLabel->
  "In[2213]:=",ExpressionUUID->"3a334192-53f9-4bb6-8397-69fea157c317"],

Cell["Generate sequence from Fibonacci sequence modulo n", "Text",
 CellChangeTimes->{{3.792623956825989*^9, 
  3.792623996851534*^9}},ExpressionUUID->"bf9849c9-f9a3-4c12-ad78-\
96beb2cf60a9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"seqLen", " ", "=", " ", "6000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"genSeq", " ", "=", " ", 
   RowBox[{"StringJoin", " ", "[", 
    RowBox[{"ToString", " ", "/@", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"Fibonacci", "[", "#", "]"}], ",", "4"}], "]"}], "&"}], "/@", 
       RowBox[{"Range", "[", "seqLen", "]"}]}], ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"StringTake", "[", 
  RowBox[{"genSeq", ",", "50"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7926240024959717`*^9, 3.7926241656934566`*^9}, {
  3.792624209103607*^9, 3.792624209202918*^9}, {3.7926242982692966`*^9, 
  3.79262431362768*^9}, {3.7926244010812473`*^9, 3.792624401571189*^9}, {
  3.792626680537079*^9, 3.792626680608184*^9}, {3.7926288729750566`*^9, 
  3.792628893467018*^9}, {3.792629346246524*^9, 3.792629348332697*^9}, {
  3.7926297330672913`*^9, 3.792629734025607*^9}},
 CellLabel->
  "In[2336]:=",ExpressionUUID->"f520b915-f165-470e-9e17-5d29760f280f"],

Cell[BoxData["\<\"11231011231011231011231011231011231011231011231011\"\>"], \
"Output",
 CellChangeTimes->{{3.7926243067348547`*^9, 3.792624313971534*^9}, 
   3.792624402436612*^9, 3.792626681162614*^9, {3.792628874010213*^9, 
   3.79262889369095*^9}, {3.79262971980064*^9, 3.792629736402218*^9}},
 CellLabel->
  "Out[2338]=",ExpressionUUID->"22faf63c-a317-4e62-bd50-5a2e8570c8be"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Build tree from sequence", "Subsection",
 CellChangeTimes->{{3.792623843223528*^9, 
  3.792623848679709*^9}},ExpressionUUID->"6c196596-01d6-4f3b-b21e-\
845e4b115ae3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Build", " ", "tree", " ", "from", " ", "sequence"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"seq", " ", "=", " ", "genSeq"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"seqLen", " ", "=", " ", 
     RowBox[{"StringLength", "[", "seq", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"L", " ", "=", " ", "8"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"subSeqs", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"StringTake", "[", 
        RowBox[{"seq", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"i", "+", "L", "-", "1"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"seqLen", "-", "L", "+", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"treeData", "=", 
     RowBox[{
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", "subSeq", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"subStrings", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"StringTake", "[", 
             RowBox[{"subSeq", ",", "#"}], "]"}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"0", ",", "L"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Take", "[", 
            RowBox[{"subStrings", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "2"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Take", "[", 
            RowBox[{"subStrings", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "}"}]}]}], 
       "\[IndentingNewLine]", "]"}], "/@", "subSeqs"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tree", "=", 
     RowBox[{"TreeGraph", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "\[Rule]", " ", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
          ")"}], "&"}], "/@", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Transpose", "[", 
          RowBox[{"(", 
           RowBox[{"Flatten", "/@", 
            RowBox[{"Transpose", "[", "treeData", "]"}]}], ")"}], "]"}], 
         "]"}]}], "\[IndentingNewLine]", ",", 
       RowBox[{"VertexLabels", "\[Rule]", "\"\<Name\>\""}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"VertexCount", "[", "tree", "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.69403461527853*^9, 3.6940346329091077`*^9}, {
   3.694034664260865*^9, 3.6940346698046894`*^9}, {3.694034760828045*^9, 
   3.6940348022139783`*^9}, {3.694034857202705*^9, 3.6940348615753036`*^9}, {
   3.6940349050444555`*^9, 3.694034908259322*^9}, {3.694034995423515*^9, 
   3.6940350267825203`*^9}, {3.694035064364908*^9, 3.694035084670821*^9}, {
   3.6940351171140194`*^9, 3.6940351348370247`*^9}, {3.694035301097641*^9, 
   3.694035317533746*^9}, {3.6940353763113728`*^9, 3.6940353829759045`*^9}, {
   3.6940354333742495`*^9, 3.694035440248575*^9}, {3.6940354849984093`*^9, 
   3.694035543978236*^9}, {3.6940355901661835`*^9, 3.694035591526932*^9}, {
   3.694036118846408*^9, 3.6940361559418364`*^9}, {3.6940361988590555`*^9, 
   3.694036202243432*^9}, {3.6940363323593454`*^9, 3.694036411292633*^9}, {
   3.6940369716099415`*^9, 3.694036972130461*^9}, {3.694489787653203*^9, 
   3.6944897884049115`*^9}, {3.6944959337837124`*^9, 
   3.6944959342292867`*^9}, {3.694495970031704*^9, 3.694495971036912*^9}, {
   3.694496043540039*^9, 3.694496047556964*^9}, {3.6944961282341146`*^9, 
   3.694496129032846*^9}, {3.694496270813332*^9, 3.694496283430852*^9}, {
   3.694496354447774*^9, 3.6944963668092065`*^9}, {3.6944964474355426`*^9, 
   3.694496447796178*^9}, {3.69449648415458*^9, 3.6944964945487394`*^9}, {
   3.694496834545661*^9, 3.6944968372658205`*^9}, {3.694496912264458*^9, 
   3.6944969381675873`*^9}, {3.69449698752724*^9, 3.6944969881058617`*^9}, {
   3.694497053545057*^9, 3.6944970540150633`*^9}, {3.6944971042598085`*^9, 
   3.694497134081242*^9}, {3.6944972173433228`*^9, 3.6944972196132174`*^9}, {
   3.6944975040958247`*^9, 3.6944975057967424`*^9}, {3.694547659410697*^9, 
   3.694547660068164*^9}, {3.6945477087067738`*^9, 3.6945477413473897`*^9}, {
   3.6945477975460515`*^9, 3.6945478667602434`*^9}, {3.6945483887929525`*^9, 
   3.694548488209482*^9}, {3.6945485209838147`*^9, 3.694548575881632*^9}, {
   3.6945486132692175`*^9, 3.694548613560425*^9}, {3.6945488133887177`*^9, 
   3.694548842173215*^9}, {3.694548900931687*^9, 3.6945489446947107`*^9}, {
   3.694550204571204*^9, 3.6945502108236504`*^9}, {3.694550414896102*^9, 
   3.6945504303821306`*^9}, {3.694550469282546*^9, 3.694550469438656*^9}, {
   3.694550520578043*^9, 3.6945505210203433`*^9}, {3.694550583838028*^9, 
   3.6945505839681053`*^9}, 3.694550963101056*^9, {3.6945510137374935`*^9, 
   3.69455103405797*^9}, {3.6945511683063517`*^9, 3.694551168605564*^9}, {
   3.6945512802725334`*^9, 3.694551280712846*^9}, {3.694553633538605*^9, 
   3.694553634354805*^9}, {3.694553687764323*^9, 3.694553753538562*^9}, {
   3.694553825280754*^9, 3.6945538256410103`*^9}, {3.6945539589464965`*^9, 
   3.6945539608288283`*^9}, {3.694554923866254*^9, 3.6945549354171224`*^9}, {
   3.6945551845616083`*^9, 3.694555204699689*^9}, {3.6945552989054875`*^9, 
   3.6945552992497344`*^9}, {3.694555353444656*^9, 3.694555403907633*^9}, {
   3.6945555520955095`*^9, 3.6945555731000433`*^9}, 3.6945556261145697`*^9, {
   3.694555678713955*^9, 3.694555698143445*^9}, 3.6945559483879137`*^9, {
   3.694556002615928*^9, 3.69455606177392*^9}, {3.69455609704002*^9, 
   3.694556150053971*^9}, {3.6945562361842985`*^9, 3.6945562362983847`*^9}, {
   3.694556497505411*^9, 3.6945564977705727`*^9}, {3.6945565307811604`*^9, 
   3.6945565730178957`*^9}, {3.6945566334772987`*^9, 
   3.6945566567189016`*^9}, {3.694556689294014*^9, 3.6945566894311104`*^9}, {
   3.6945567826275616`*^9, 3.6945567905570383`*^9}, {3.6945569756071167`*^9, 
   3.6945569888619747`*^9}, {3.69455702758444*^9, 3.6945570279396825`*^9}, {
   3.6945571182746725`*^9, 3.694557125291666*^9}, {3.6945571723572044`*^9, 
   3.6945571733588953`*^9}, {3.6945573090473604`*^9, 
   3.6945573091604404`*^9}, {3.694557448443838*^9, 3.6945574485859337`*^9}, {
   3.6945574804608097`*^9, 3.6945575027457275`*^9}, {3.6945576572930403`*^9, 
   3.6945576574323144`*^9}, {3.6945578651269207`*^9, 3.69455786534908*^9}, {
   3.6945579989285736`*^9, 3.694557999370859*^9}, 3.6945581120882607`*^9, {
   3.6945581903985853`*^9, 3.694558192020722*^9}, 3.6945584977750206`*^9, {
   3.6945587754604063`*^9, 3.694558783770246*^9}, {3.694576707973666*^9, 
   3.694576708731917*^9}, {3.694576865163929*^9, 3.694576865446933*^9}, {
   3.694577017929674*^9, 3.694577018561471*^9}, {3.6945770685048027`*^9, 
   3.6945770901423993`*^9}, {3.6945771459689245`*^9, 
   3.6945771472422595`*^9}, {3.6945778182429233`*^9, 3.694577818532405*^9}, {
   3.6945782103280754`*^9, 3.6945782106652737`*^9}, {3.6945783437458487`*^9, 
   3.694578344022538*^9}, 3.6945787391968126`*^9, {3.7923706294109983`*^9, 
   3.792370630225918*^9}, {3.792376036097254*^9, 3.792376036989868*^9}, {
   3.792377089628759*^9, 3.792377090058608*^9}, {3.7923771729964743`*^9, 
   3.792377176520089*^9}, {3.792624142706645*^9, 3.792624143458597*^9}, {
   3.7926287905127897`*^9, 3.7926287914925957`*^9}, {3.792628901351029*^9, 
   3.792628902421658*^9}, {3.792628991835528*^9, 3.792629008576252*^9}, {
   3.7926291368791533`*^9, 3.792629137157493*^9}, {3.792629283309244*^9, 
   3.792629284041685*^9}, {3.7926293373040953`*^9, 3.792629337955805*^9}, 
   3.792629597520878*^9, {3.79262963303823*^9, 3.79262963325917*^9}},
 CellLabel->
  "In[2339]:=",ExpressionUUID->"9d0133f8-f8c2-4496-a150-32373d116d08"],

Cell[BoxData["47"], "Print",
 CellChangeTimes->{{3.694556788504562*^9, 3.6945568226062336`*^9}, 
   3.6945568546635976`*^9, {3.69455698583449*^9, 3.6945569970862026`*^9}, {
   3.694557028262911*^9, 3.6945570652625313`*^9}, {3.6945571226817975`*^9, 
   3.6945571295436845`*^9}, {3.694557167372631*^9, 3.694557177500623*^9}, {
   3.6945573119614305`*^9, 3.694557342106244*^9}, {3.694557425015179*^9, 
   3.6945574664039536`*^9}, {3.6945575033532195`*^9, 
   3.6945575226487503`*^9}, {3.6945576240596027`*^9, 3.694557627202839*^9}, {
   3.6945576608676224`*^9, 3.694557664577237*^9}, {3.6945577754258757`*^9, 
   3.694557779969334*^9}, {3.694557867332356*^9, 3.6945578738683825`*^9}, {
   3.694558001830614*^9, 3.6945580093764954`*^9}, 3.6945581152154818`*^9, {
   3.694558195154976*^9, 3.6945582162540693`*^9}, 3.694558248898245*^9, 
   3.694558281026853*^9, {3.6945584918905606`*^9, 3.6945585032499104`*^9}, 
   3.694558556459263*^9, 3.6945590519396133`*^9, 3.694559090345848*^9, 
   3.6945591311063013`*^9, {3.6945591748165607`*^9, 3.694559203482156*^9}, {
   3.6945767109720535`*^9, 3.6945767342349515`*^9}, {3.694576865828968*^9, 
   3.6945768726884*^9}, {3.69457696807123*^9, 3.6945769874876895`*^9}, {
   3.6945770190441737`*^9, 3.694577026952093*^9}, {3.69457706894874*^9, 
   3.694577106902334*^9}, {3.694577148932477*^9, 3.6945771594574714`*^9}, {
   3.69457764586827*^9, 3.6945778551053953`*^9}, 3.6945780147444954`*^9, {
   3.6945780887976313`*^9, 3.6945781278977723`*^9}, {3.694578219213383*^9, 
   3.694578258752973*^9}, {3.694578352885434*^9, 3.6945783821886163`*^9}, 
   3.694578430719652*^9, {3.6945787589391356`*^9, 3.6945787660028534`*^9}, 
   3.6945788274089947`*^9, 3.7923685781681423`*^9, {3.79236952358043*^9, 
   3.792369542070388*^9}, 3.7923705632067947`*^9, 3.7923706308860407`*^9, 
   3.792370785309499*^9, {3.7923760214197273`*^9, 3.792376038620775*^9}, 
   3.792376138039165*^9, 3.792376216881949*^9, 3.792376349680954*^9, 
   3.792376491904642*^9, {3.7923767213985357`*^9, 3.79237674024617*^9}, 
   3.792377093367449*^9, {3.792377162802485*^9, 3.792377177223501*^9}, {
   3.792624130227167*^9, 3.7926241689493856`*^9}, 3.7926242141899567`*^9, 
   3.792624413124319*^9, 3.79262668485156*^9, 3.792628706667974*^9, 
   3.792628792029386*^9, {3.792628896822562*^9, 3.792628902759861*^9}, {
   3.7926289937966557`*^9, 3.7926290088517427`*^9}, 3.792629101316566*^9, 
   3.7926291378954363`*^9, {3.79262928484584*^9, 3.792629305871365*^9}, {
   3.792629338952285*^9, 3.792629357211404*^9}, {3.7926295690421867`*^9, 
   3.7926296336052094`*^9}, {3.792629721273992*^9, 3.792629738141227*^9}},
 CellLabel->
  "During evaluation of \
In[2339]:=",ExpressionUUID->"b6524b76-7524-4992-93cf-9df7390521e2"]
}, Open  ]],

Cell["Build \[Epsilon]-machine from tree using depth subL subtrees", "Text",
 CellChangeTimes->{
  3.7926238577650347`*^9},ExpressionUUID->"f1bfdbe7-9f5f-4f81-bcfd-\
66551a51444a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vertices", " ", "=", " ", 
   RowBox[{"VertexList", "[", "tree", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"subL", " ", "=", " ", "4"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "To", " ", "determine", " ", "the", " ", "depth", " ", "of", " ", "the", 
     " ", "subtree"}], ",", " ", 
    RowBox[{
     RowBox[{
     "we", " ", "compare", " ", "the", " ", "subtree", " ", "of", " ", 
      "depth", " ", "subL", " ", "to", " ", "the", " ", "subtree", " ", "of", 
      " ", "depth", " ", "subL"}], "-", 
     RowBox[{
     "1.", " ", "If", " ", "the", " ", "tree", " ", "depth", " ", "is", " ", 
      "in", " ", "fact", " ", "smaller", " ", "than", " ", "subL"}]}], ",", 
    " ", 
    RowBox[{"the", " ", "vertex", " ", "list", " ", "will", " ", "be", " ", 
     RowBox[{"identical", ".", " ", "VertexOutComponent"}], " ", "does", " ", 
     "not", " ", "behave", " ", "correctly", " ", "for", " ", "depth", " ", 
     "zero"}], ",", " ", 
    RowBox[{
    "so", " ", "the", " ", "conditional", " ", "returns", " ", "the", " ", 
     "root", " ", "node", " ", "if", " ", "the", " ", "depth", " ", "is", " ",
      "0"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"subTreeRoots", ",", "subTreeVertices"}], " ", "}"}], "=", 
    RowBox[{"Transpose", "[", 
     RowBox[{"Select", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Transpose", "[", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"vertices", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"VertexOutComponent", "[", 
             RowBox[{"tree", ",", "#", ",", "subL"}], "]"}], "&"}], "/@", 
           "vertices"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
           "\[NotEqual]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"subL", "-", "1"}], " ", "\[Equal]", " ", "0"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "}"}], ",", 
            RowBox[{"VertexOutComponent", "[", 
             RowBox[{"tree", ",", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"subL", "-", "1"}]}], "]"}]}], "]"}]}], ")"}], "&"}]}], 
      "]"}], "]"}]}], ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Remove", " ", "name", " ", "of", " ", "root", " ", "node", " ", "from", 
     " ", "the", " ", "name", " ", "of", " ", "each", " ", "node"}], ",", " ", 
    RowBox[{"to", " ", "compare", " ", "tree", " ", "structure"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"treeStructures", "=", 
    RowBox[{
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "vertexList", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "vertexList", "]"}], "<", 
          RowBox[{"subL", "+", "1"}]}], ",", 
         RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", "string", "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"StringDrop", "[", 
              RowBox[{"string", ",", 
               RowBox[{"StringLength", "[", 
                RowBox[{
                "vertexList", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "]"}]}], "]"}]}], "]"}], "/@", 
           "vertexList"}], ")"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], "/@",
      "subTreeVertices"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Comparisons", " ", "should", " ", "not", " ", "depend", " ", "on", " ", 
    "order", " ", "of", " ", "vertices"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"treeStructures", " ", "=", " ", 
   RowBox[{"Sort", "/@", "treeStructures"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"equivalenceIndices", "=", 
   RowBox[{"EquivalenceIndices", "[", 
    RowBox[{"treeStructures", ",", "Equal"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"classNames", " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"FromCharacterCode", "[", 
      RowBox[{"64", "+", "#"}], "]"}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"Length", "[", "equivalenceIndices", "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"edgeList", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"labelList", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sourceVertexIndexList", " ", "=", " ", 
      RowBox[{
      "equivalenceIndices", "\[LeftDoubleBracket]", "sourceIndex", 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", "sourceVertexIndex", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"targetVertexIndexList", " ", "=", " ", 
          RowBox[{
          "equivalenceIndices", "\[LeftDoubleBracket]", "targetIndex", 
           "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", "targetVertexIndex", "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"isEdge", " ", "=", " ", 
              RowBox[{"EdgeQ", "[", 
               RowBox[{"tree", ",", 
                RowBox[{
                 RowBox[{
                 "subTreeRoots", "\[LeftDoubleBracket]", "sourceVertexIndex", 
                  "\[RightDoubleBracket]"}], "\[DirectedEdge]", " ", 
                 RowBox[{
                 "subTreeRoots", "\[LeftDoubleBracket]", "targetVertexIndex", 
                  "\[RightDoubleBracket]"}]}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"edgeList", " ", "=", 
              RowBox[{"If", "[", 
               RowBox[{"isEdge", ",", "\[IndentingNewLine]", 
                RowBox[{"Append", "[", 
                 RowBox[{"edgeList", ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                   "classNames", "\[LeftDoubleBracket]", "sourceIndex", 
                    "\[RightDoubleBracket]"}], "\[DirectedEdge]", " ", 
                   RowBox[{
                   "classNames", "\[LeftDoubleBracket]", "targetIndex", 
                    "\[RightDoubleBracket]"}]}]}], "]"}], ",", 
                "\[IndentingNewLine]", "edgeList"}], "\[IndentingNewLine]", 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"labelList", " ", "=", " ", 
              RowBox[{"If", "[", 
               RowBox[{"isEdge", ",", "\[IndentingNewLine]", 
                RowBox[{"Append", "[", 
                 RowBox[{"labelList", ",", 
                  RowBox[{"StringTake", "[", 
                   RowBox[{
                    RowBox[{
                    "subTreeRoots", "\[LeftDoubleBracket]", 
                    "targetVertexIndex", "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], "]"}], ",", 
                "\[IndentingNewLine]", "labelList"}], "\[IndentingNewLine]", 
               "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], "/@", 
          "targetVertexIndexList"}]}]}], "\[IndentingNewLine]", "]"}], "/@", 
      "sourceVertexIndexList"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"sourceIndex", ",", 
      RowBox[{"Length", "[", "classNames", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"targetIndex", ",", 
      RowBox[{"Length", "[", "classNames", "]"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"edgeList", ",", "labelList"}], "}"}], " ", "=", " ", 
   RowBox[{"Transpose", "[", 
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"edgeList", ",", "labelList"}], "}"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EdgeLabeler", "[", 
    RowBox[{"edgePoints_", ",", "edge_"}], "]"}], ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Text", "[", 
      RowBox[{
       RowBox[{"labelList", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"edgeList", ",", "edge"}], "]"}], "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], 
        "\[RightDoubleBracket]"}], ",", 
       RowBox[{"Mean", "@", "edgePoints"}]}], "]"}], ",", 
     RowBox[{"Arrow", "@", "edgePoints"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"machine", "=", 
   RowBox[{"Graph", "[", 
    RowBox[{"edgeList", ",", 
     RowBox[{"VertexLabels", "\[Rule]", "\"\<Name\>\""}], ",", 
     RowBox[{"EdgeShapeFunction", "\[Rule]", "EdgeLabeler"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Graph", "[", "machine", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"MatrixForm", "[", 
   RowBox[{"{", 
    RowBox[{"edgeList", ",", "labelList"}], "}"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.694036975114624*^9, 3.694036999931322*^9}, {
   3.694037041161055*^9, 3.694037091495468*^9}, {3.694037452494234*^9, 
   3.6940375074274273`*^9}, 3.694491334656884*^9, {3.694491984251526*^9, 
   3.6944920169881525`*^9}, {3.6944952109268785`*^9, 
   3.6944952683105917`*^9}, {3.694495324621874*^9, 3.6944953558708053`*^9}, {
   3.694495703836763*^9, 3.6944957040484576`*^9}, {3.6944957406020336`*^9, 
   3.6944957626443577`*^9}, {3.694495938340626*^9, 3.6944959389212513`*^9}, {
   3.694495996989461*^9, 3.6944959970910416`*^9}, 3.694496259917506*^9, {
   3.694496303538376*^9, 3.694496303664042*^9}, {3.6944963749549923`*^9, 
   3.694496375116191*^9}, {3.694497224686307*^9, 3.694497225202552*^9}, {
   3.6944974486240416`*^9, 3.6944974894437785`*^9}, {3.6944976706516004`*^9, 
   3.6944977428992133`*^9}, {3.6945471631631165`*^9, 3.694547188991481*^9}, {
   3.694547435330019*^9, 3.6945476316909704`*^9}, {3.694547725330988*^9, 
   3.6945477354622164`*^9}, {3.694547872065016*^9, 3.6945478722381663`*^9}, {
   3.6945480970654645`*^9, 3.6945480978290215`*^9}, {3.6945483104965763`*^9, 
   3.6945483381694503`*^9}, {3.694548470551117*^9, 3.694548481914198*^9}, {
   3.6945485673034534`*^9, 3.6945485790678835`*^9}, {3.6945488710278015`*^9, 
   3.6945488920273542`*^9}, {3.6945489561078267`*^9, 3.694548956237922*^9}, {
   3.694550423941548*^9, 3.6945504952039976`*^9}, {3.6945505285116835`*^9, 
   3.6945505347771397`*^9}, {3.694550567113134*^9, 3.6945505672772503`*^9}, {
   3.694550649006379*^9, 3.6945506721178093`*^9}, {3.6945507261396046`*^9, 
   3.694550726624977*^9}, {3.694550943239083*^9, 3.6945509433551507`*^9}, {
   3.694550979101946*^9, 3.694550992807446*^9}, {3.694551262537151*^9, 
   3.6945512629684577`*^9}, {3.6945536505488605`*^9, 3.694553671781951*^9}, {
   3.694553702010174*^9, 3.6945537195205965`*^9}, {3.6945538152926226`*^9, 
   3.6945538165345345`*^9}, {3.6945539539519444`*^9, 3.694553954071024*^9}, {
   3.6945551497497544`*^9, 3.6945551499118423`*^9}, {3.694555291313521*^9, 
   3.694555291507667*^9}, {3.694555348820456*^9, 3.6945553490586243`*^9}, {
   3.6945555492584925`*^9, 3.694555549360563*^9}, {3.6945556218114877`*^9, 
   3.694555621932576*^9}, {3.6945557465227213`*^9, 3.694555775962058*^9}, {
   3.6945558463874083`*^9, 3.69455584650447*^9}, {3.694555885094716*^9, 
   3.6945558851687393`*^9}, {3.694555940574305*^9, 3.694555945751038*^9}, {
   3.6945560740247936`*^9, 3.6945561402165327`*^9}, {3.694556172203453*^9, 
   3.694556172838889*^9}, {3.6945570046320896`*^9, 3.6945570216130958`*^9}, {
   3.6945571360023513`*^9, 3.6945571630845995`*^9}, {3.6945573553806334`*^9, 
   3.6945573554947157`*^9}, {3.6945574435093403`*^9, 3.694557444118778*^9}, {
   3.694557487223817*^9, 3.6945574964999447`*^9}, {3.694557640612329*^9, 
   3.694557650028037*^9}, {3.6945579106511235`*^9, 3.69455791109544*^9}, {
   3.694557945374853*^9, 3.6945579454518876`*^9}, {3.694558041690831*^9, 
   3.6945580418939753`*^9}, {3.6945580864485235`*^9, 
   3.6945580865475874`*^9}, {3.694558187332384*^9, 3.694558188272051*^9}, {
   3.694558504611946*^9, 3.6945585048161154`*^9}, {3.6945587971029787`*^9, 
   3.694558837989946*^9}, {3.694576859863428*^9, 3.694576860053138*^9}, {
   3.6945770625438223`*^9, 3.694577062660448*^9}, {3.6945771294443884`*^9, 
   3.694577139325254*^9}, {3.6945778063601656`*^9, 3.694577807172627*^9}, {
   3.6945779479767847`*^9, 3.6945779862719946`*^9}, {3.694578132562929*^9, 
   3.694578202587348*^9}, {3.694578260392495*^9, 3.694578336824386*^9}, {
   3.69457845984026*^9, 3.694578488572256*^9}, {3.694578834142779*^9, 
   3.694578834322521*^9}, {3.792370899063858*^9, 3.792370907535078*^9}, {
   3.792373698457049*^9, 3.7923737013319273`*^9}, {3.792373810488553*^9, 
   3.7923739252347317`*^9}, 3.792373989689909*^9, {3.7923740200377073`*^9, 
   3.7923740778503323`*^9}, {3.792374120612288*^9, 3.792374122514752*^9}, {
   3.792374170042646*^9, 3.792374258370833*^9}, {3.7923743019621477`*^9, 
   3.792374315653448*^9}, {3.792375241961424*^9, 3.792375255726486*^9}, {
   3.792375315036306*^9, 3.792375469847742*^9}, {3.792375518064045*^9, 
   3.7923755218340683`*^9}, {3.7923770959545097`*^9, 3.792377124801198*^9}, {
   3.792623861766526*^9, 3.792623882822057*^9}, {3.792624530203556*^9, 
   3.792624540939788*^9}, {3.792625165800774*^9, 3.792625169183852*^9}, {
   3.79262556262604*^9, 3.7926256498072033`*^9}, {3.792625780733345*^9, 
   3.79262583369067*^9}, {3.7926258859154577`*^9, 3.792625902326765*^9}, {
   3.792626014501945*^9, 3.792626057458743*^9}, {3.792626160931328*^9, 
   3.792626192965836*^9}, {3.7926262233733587`*^9, 3.7926262646248417`*^9}, {
   3.792626315207821*^9, 3.792626326541017*^9}, {3.7926263657407827`*^9, 
   3.792626404086915*^9}, {3.79262649959951*^9, 3.792626591002597*^9}, {
   3.7926266544217987`*^9, 3.792626655020211*^9}, {3.792629119850297*^9, 
   3.792629128228311*^9}, {3.7926292753112383`*^9, 3.79262927582932*^9}, {
   3.792629329704713*^9, 3.792629330050473*^9}, {3.79262938235256*^9, 
   3.7926294024701757`*^9}, {3.792629591994569*^9, 3.792629594567089*^9}},
 CellLabel->
  "In[2346]:=",ExpressionUUID->"a60a45ba-1fd1-4a51-abfb-8571a225e729"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{
      "A", "E", "B", "F", "C", "D", "G", "H"}, {{{1, 2}, {3, 4}, {5, 1}, {6, 
       5}, {2, 3}, {4, 6}, {7, 1}, {7, 3}, {7, 5}, {7, 8}, {8, 3}, {8, 5}, {8,
        6}}, Null}, {
      EdgeShapeFunction -> {$CellContext`EdgeLabeler}, 
       VertexLabels -> {"Name"}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[
        0.7], {InsetBox["\<\"1\"\>", {2.358775556623043, 0.9654631771286387}],
          ArrowBox[{{2.329756969622287, 0.4239289616236446}, {
          2.3877941436237986`, 1.5069973926336329`}}]}, {
         InsetBox["\<\"0\"\>", {1.7905450234503868, 1.5169097376528708}], 
         ArrowBox[{{2.3877941436237986`, 1.5069973926336329`}, {
          1.193295903276975, 1.5268220826721088`}}]}, {
         InsetBox["\<\"1\"\>", {0.5966479516384875, 1.516212559781669}], 
         ArrowBox[{{1.193295903276975, 1.5268220826721088`}, {0., 
          1.505603036891229}}]}, {
         InsetBox["\<\"1\"\>", {0.030760812751304933, 0.963913344717702}], 
         ArrowBox[{{0., 1.505603036891229}, {0.06152162550260987, 
          0.42222365254417493`}}]}, {
         InsetBox["\<\"3\"\>", {1.7631590532760968, 0.2119644808118223}], 
         ArrowBox[{{1.1965611369299067`, 0.}, {2.329756969622287, 
          0.4239289616236446}}]}, {
         InsetBox["\<\"2\"\>", {0.6290413812162583, 0.21111182627208747}], 
         ArrowBox[{{0.06152162550260987, 0.42222365254417493`}, {
          1.1965611369299067`, 0.}}]}, {
         InsetBox["\<\"3\"\>", {1.964839809500817, 0.5454372039241626}], 
         ArrowBox[{{1.599922649379347, 0.6669454462246807}, {
          2.329756969622287, 0.4239289616236446}}]}, {
         InsetBox["\<\"0\"\>", {1.396609276328161, 1.0968837644483949}], 
         ArrowBox[{{1.599922649379347, 0.6669454462246807}, {
          1.193295903276975, 1.5268220826721088`}}]}, {
         InsetBox["\<\"2\"\>", {1.3982418931546268, 0.33347272311234033}], 
         ArrowBox[{{1.599922649379347, 0.6669454462246807}, {
          1.1965611369299067`, 0.}}]}, {
         InsetBox["\<\"1\"\>", {1.194525458281226, 0.6660557467003501}], 
         ArrowBox[{{1.599922649379347, 0.6669454462246807}, {
          0.7891282671831046, 0.6651660471760193}}]}, {
         InsetBox["\<\"0\"\>", {0.9912120852300398, 1.095994064924064}], 
         ArrowBox[{{0.7891282671831046, 0.6651660471760193}, {
          1.193295903276975, 1.5268220826721088`}}]}, {
         InsetBox["\<\"2\"\>", {0.9928447020565057, 0.3325830235880097}], 
         ArrowBox[{{0.7891282671831046, 0.6651660471760193}, {
          1.1965611369299067`, 0.}}]}, {
         InsetBox["\<\"1\"\>", {0.4253249463428572, 0.5436948498600971}], 
         ArrowBox[{{0.7891282671831046, 0.6651660471760193}, {
          0.06152162550260987, 0.42222365254417493`}}]}}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[
        0.7]}], {
         DiskBox[{2.329756969622287, 0.4239289616236446}, 
          0.02568214870572072], 
         InsetBox["\<\"A\"\>", 
          Offset[{2, 2}, {2.355439118328008, 0.4496111103293653}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{2.3877941436237986, 1.5069973926336329}, 
          0.02568214870572072], 
         InsetBox["\<\"E\"\>", 
          Offset[{2, 2}, {2.4134762923295194, 1.5326795413393537}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{1.193295903276975, 1.5268220826721088}, 
          0.02568214870572072], 
         InsetBox["\<\"B\"\>", 
          Offset[{2, 2}, {1.2189780519826958, 1.5525042313778297}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{0., 1.505603036891229}, 0.02568214870572072], 
         InsetBox["\<\"F\"\>", 
          Offset[{2, 2}, {0.02568214870572072, 1.5312851855969498}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{1.1965611369299067, 0.}, 0.02568214870572072], 
         InsetBox["\<\"C\"\>", 
          Offset[{2, 2}, {1.2222432856356273, 0.02568214870572072}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{0.06152162550260987, 0.42222365254417493}, 
          0.02568214870572072], 
         InsetBox["\<\"D\"\>", 
          Offset[{2, 2}, {0.08720377420833059, 0.44790580124989565}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{1.599922649379347, 0.6669454462246807}, 
          0.02568214870572072], 
         InsetBox["\<\"G\"\>", 
          Offset[{2, 2}, {1.6256047980850679, 0.6926275949304014}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{0.7891282671831046, 0.6651660471760193}, 
          0.02568214870572072], 
         InsetBox["\<\"H\"\>", 
          Offset[{2, 2}, {0.8148104158888253, 0.6908481958817401}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None,
  ImageSize->{586.2819602272727, Automatic}]], "Output",
 CellChangeTimes->{{3.792375453832388*^9, 3.792375470146742*^9}, 
   3.79237552261793*^9, {3.7923760224690742`*^9, 3.7923760404412947`*^9}, 
   3.79237613918539*^9, 3.792376218259804*^9, 3.792376351354431*^9, 
   3.792376493763995*^9, {3.792376723513111*^9, 3.792376741884274*^9}, {
   3.792377096403432*^9, 3.792377125326676*^9}, {3.792377164202861*^9, 
   3.79237717845785*^9}, 3.7926241331576357`*^9, 3.792624170880117*^9, 
   3.792624218370022*^9, 3.792624414363401*^9, 3.79262516990175*^9, 
   3.792625572028534*^9, 3.7926256520835114`*^9, {3.792625792814063*^9, 
   3.7926258340920897`*^9}, {3.792626384365283*^9, 3.7926264044515553`*^9}, {
   3.7926265224377327`*^9, 3.792626536667591*^9}, 3.79262659327207*^9, {
   3.792626662303308*^9, 3.792626685891192*^9}, 3.792628709267947*^9, 
   3.792628794547412*^9, 3.7926289047171307`*^9, {3.792628996973*^9, 
   3.792629010529235*^9}, {3.792629103071333*^9, 3.792629139412965*^9}, {
   3.7926292766529417`*^9, 3.7926294028089333`*^9}, {3.7926295733314037`*^9, 
   3.7926296351521177`*^9}, {3.792629722949814*^9, 3.792629739865221*^9}},
 CellLabel->
  "Out[2359]=",ExpressionUUID->"cbf9b58f-7c0c-4998-b116-400a7309ab0c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"\<\"A\"\>", "\[DirectedEdge]", "\<\"E\"\>"}], 
      RowBox[{"\<\"B\"\>", "\[DirectedEdge]", "\<\"F\"\>"}], 
      RowBox[{"\<\"C\"\>", "\[DirectedEdge]", "\<\"A\"\>"}], 
      RowBox[{"\<\"D\"\>", "\[DirectedEdge]", "\<\"C\"\>"}], 
      RowBox[{"\<\"E\"\>", "\[DirectedEdge]", "\<\"B\"\>"}], 
      RowBox[{"\<\"F\"\>", "\[DirectedEdge]", "\<\"D\"\>"}], 
      RowBox[{"\<\"G\"\>", "\[DirectedEdge]", "\<\"A\"\>"}], 
      RowBox[{"\<\"G\"\>", "\[DirectedEdge]", "\<\"B\"\>"}], 
      RowBox[{"\<\"G\"\>", "\[DirectedEdge]", "\<\"C\"\>"}], 
      RowBox[{"\<\"G\"\>", "\[DirectedEdge]", "\<\"H\"\>"}], 
      RowBox[{"\<\"H\"\>", "\[DirectedEdge]", "\<\"B\"\>"}], 
      RowBox[{"\<\"H\"\>", "\[DirectedEdge]", "\<\"C\"\>"}], 
      RowBox[{"\<\"H\"\>", "\[DirectedEdge]", "\<\"D\"\>"}]},
     {"\<\"1\"\>", "\<\"1\"\>", "\<\"3\"\>", "\<\"2\"\>", "\<\"0\"\>", "\<\"1\
\"\>", "\<\"3\"\>", "\<\"0\"\>", "\<\"2\"\>", "\<\"1\"\>", "\<\"0\"\>", \
"\<\"2\"\>", "\<\"1\"\>"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.6944962862381268`*^9, 3.694496304268268*^9}, 
   3.6944963753752317`*^9, 3.6944968560073395`*^9, {3.69449691541678*^9, 
   3.6944969413955865`*^9}, 3.694496991002598*^9, 3.6944970565401506`*^9, 
   3.694497107503565*^9, 3.6944971589914875`*^9, 3.6944972261390285`*^9, {
   3.6944974703210936`*^9, 3.694497507686556*^9}, {3.694547169937928*^9, 
   3.694547189302699*^9}, 3.6945474693320975`*^9, 3.6945476632183757`*^9, {
   3.6945477258233337`*^9, 3.6945477437640905`*^9}, {3.694547848233066*^9, 
   3.694547872625412*^9}, 3.694548098174267*^9, {3.6945483128882627`*^9, 
   3.6945483387138186`*^9}, 3.694548415115654*^9, {3.694548465891776*^9, 
   3.6945484901248546`*^9}, {3.694548567762766*^9, 3.6945485793710957`*^9}, 
   3.6945486196147027`*^9, {3.694548846002909*^9, 3.694548892348555*^9}, 
   3.6945489564610763`*^9, {3.6945504243428335`*^9, 3.6945505351473737`*^9}, {
   3.6945505676114597`*^9, 3.6945505898562775`*^9}, {3.6945506498059483`*^9, 
   3.694550672482067*^9}, 3.6945507271002855`*^9, {3.6945509231994133`*^9, 
   3.6945510383550105`*^9}, {3.694551146745446*^9, 3.694551170787673*^9}, {
   3.694551263662963*^9, 3.6945512847253056`*^9}, 3.6945527145192213`*^9, 
   3.694552772671929*^9, 3.6945533456871147`*^9, 3.694553384783918*^9, 
   3.6945535208393264`*^9, {3.694553638156372*^9, 3.6945537582458997`*^9}, {
   3.6945538172350054`*^9, 3.6945538289463587`*^9}, {3.6945539388501987`*^9, 
   3.6945539654190907`*^9}, 3.6945549398735094`*^9, 3.6945551503171415`*^9, {
   3.6945551867289605`*^9, 3.6945552064328923`*^9}, {3.694555291853905*^9, 
   3.694555300947933*^9}, {3.6945553567837915`*^9, 3.6945554072379875`*^9}, {
   3.6945555540265093`*^9, 3.6945555747412095`*^9}, 3.694555628954605*^9, {
   3.69455568107961*^9, 3.694555710063715*^9}, 3.694555752313633*^9, 
   3.6945557896227727`*^9, 3.694555850339117*^9, {3.694555881109677*^9, 
   3.694555886054369*^9}, {3.6945559413818502`*^9, 3.694555950211193*^9}, {
   3.6945559966044765`*^9, 3.694556237722271*^9}, 3.6945564546247272`*^9, {
   3.6945564869608326`*^9, 3.6945565349240746`*^9}, {3.694556567410025*^9, 
   3.6945566935330114`*^9}, {3.6945567267643166`*^9, 3.694556752368795*^9}, 
   3.694556826949828*^9, 3.694556859707182*^9, {3.694557000120384*^9, 
   3.694557022004388*^9}, 3.694557067152845*^9, {3.69455713646568*^9, 
   3.6945571793819485`*^9}, {3.694557344464869*^9, 3.694557355841959*^9}, {
   3.694557434468886*^9, 3.6945574876531277`*^9}, 3.6945575257694073`*^9, {
   3.6945576291602287`*^9, 3.69455766684685*^9}, 3.6945577814653845`*^9, 
   3.6945578760659447`*^9, 3.6945579127757883`*^9, 3.694557945956236*^9, 
   3.69455801265934*^9, 3.694558043483079*^9, {3.6945580870799637`*^9, 
   3.6945581163252707`*^9}, {3.694558218609744*^9, 3.6945582499558487`*^9}, 
   3.6945582819192452`*^9, 3.6945585052281647`*^9, 3.6945585579223037`*^9, 
   3.6945590534717293`*^9, 3.694559096420761*^9, 3.694559131991944*^9, {
   3.6945591760972905`*^9, 3.6945592042777033`*^9}, 3.694576736918064*^9, {
   3.6945768606085067`*^9, 3.694576874619774*^9}, 3.6945769899544077`*^9, 
   3.6945770286740837`*^9, {3.694577063166705*^9, 3.6945771617706685`*^9}, {
   3.69457764836078*^9, 3.6945778079160247`*^9}, 3.694577859057249*^9, {
   3.694577949537959*^9, 3.6945779928607845`*^9}, {3.6945781343053107`*^9, 
   3.6945782032329063`*^9}, {3.694578262221697*^9, 3.6945783554840813`*^9}, {
   3.694578449882457*^9, 3.694578506154326*^9}, 3.694578768202525*^9, {
   3.6945788287459164`*^9, 3.694578834655524*^9}, 3.79236858567315*^9, {
   3.792369527435658*^9, 3.792369543834635*^9}, 3.792370322941394*^9, 
   3.792370396496739*^9, 3.792370469400264*^9, 3.792370564926652*^9, 
   3.7923706342129297`*^9, 3.792370788067305*^9, {3.7923708999272213`*^9, 
   3.792370909509576*^9}, {3.792373907318899*^9, 3.7923739256949177`*^9}, 
   3.792373994524415*^9, 3.7923740355704117`*^9, 3.7923740785893383`*^9, {
   3.792374243909492*^9, 3.792374258831328*^9}, {3.7923753385667686`*^9, 
   3.792375412461441*^9}, {3.792375450532898*^9, 3.79237547015132*^9}, 
   3.792375522623475*^9, {3.792376022473893*^9, 3.7923760404468603`*^9}, 
   3.792376139189741*^9, 3.792376218264151*^9, 3.792376351361723*^9, 
   3.792376493771123*^9, {3.7923767235205917`*^9, 3.792376741887909*^9}, {
   3.792377096409181*^9, 3.7923771253315077`*^9}, {3.792377164207258*^9, 
   3.79237717846245*^9}, 3.792624133163374*^9, 3.7926241708862543`*^9, 
   3.792624218377556*^9, 3.792624414370504*^9, 3.7926251699082127`*^9, 
   3.792625572034298*^9, 3.792625652090025*^9, {3.7926257928248367`*^9, 
   3.7926258340973463`*^9}, {3.792626384373714*^9, 3.792626404459041*^9}, {
   3.792626522448098*^9, 3.7926265366728697`*^9}, 3.792626593278708*^9, {
   3.792626662308584*^9, 3.792626685899542*^9}, 3.792628709274928*^9, 
   3.792628794552458*^9, 3.792628904730227*^9, {3.7926289969782753`*^9, 
   3.792629010533884*^9}, {3.792629103077231*^9, 3.79262913942039*^9}, {
   3.792629276659568*^9, 3.792629402815508*^9}, {3.792629573351713*^9, 
   3.792629635155987*^9}, {3.792629722961852*^9, 3.79262973987175*^9}},
 CellLabel->
  "During evaluation of \
In[2346]:=",ExpressionUUID->"fe9e373e-4cdd-41e5-86d2-8446cba45594"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6945506170629873`*^9, 
  3.6945506180917463`*^9}},ExpressionUUID->"3ecf4ad3-a0d2-4493-9a21-\
a8d56397a3fd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HighlightGraph", "[", 
  RowBox[{"machine", ",", 
   RowBox[{"FindCycle", "[", "machine", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.694497365946373*^9, 3.6944973677785454`*^9}, {
  3.6945480821769056`*^9, 3.6945481201280823`*^9}, {3.6945588483398914`*^9, 
  3.6945588498809676`*^9}, {3.79262565739319*^9, 3.792625718415506*^9}, {
  3.7926257667243633`*^9, 3.7926257675265827`*^9}, {3.792626599332098*^9, 
  3.792626600269092*^9}, {3.7926266971924458`*^9, 3.7926266982585*^9}, {
  3.792627628511904*^9, 3.792627629170309*^9}},
 CellLabel->
  "In[1937]:=",ExpressionUUID->"504d4cd3-564d-41fc-8180-d38c52488b44"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{
      "A", "B", "C", "D"}, {{{1, 1}, {1, 2}, {2, 1}, {2, 3}, {3, 4}, {4, 2}}, 
       Null}, {EdgeShapeFunction -> {$CellContext`EdgeLabeler}, 
       VertexLabels -> {"Name"}, GraphHighlight -> {
         DirectedEdge["B", "A"], 
         DirectedEdge["A", "B"]}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[
        0.7], {InsetBox["\<\"1\"\>", \
{-0.2211140037273061, 0.41357983598783343}], ArrowBox[CompressedData["
1:eJxTTMoPSmViYGCQBGIQDQOaQeV8vBW37Bk6Wj416QnsN/LLO7Td/JZ9QTLH
4a0v2/b/+rbeTG3fVXuOgGOGq62X7tcTLXi4cOlF+wg1zavbl23bv3rOPYeu
ljP2EWFrpOIZDu8vLv333mXzcfsfc2onhe04vV+vcen7eKuj9stUI/JkUy7t
Fyvq153vc9T+TOustt+7ru33F3nzs/vFcftpfIser2q/tX/2JmvRyTfO2HN6
X/BWq7m7f11bcvqK2xftk54c5zsQfX+/a9Tdqpu/r9qH6H///////f1TmznO
qwDdryWikLYTKC/9P1I//8s9+2eONs2SQP0rWLL3+nU9tM/wXsg4E2i+9nev
X78dH9s/ckn69RRov5qc0vtftU/se8XiP7EC3ZfMseblJ5Wn9n1f6+rVge7n
tdSJqdd8ai+0zHGzMdB/Ybz77jt1P7FXeM4Ykg/0f/M+x03vwh7b9xwqzXEC
ho/gDH4xu6UP7QU22NpffdG2/4dr+LcvhvftGRQ0nnRpCOwXyGSISdoBDG+0
8AcAHTnGJg==
          "]]}, 
        {Hue[1, 1, 0.7], Opacity[1], 
         InsetBox["\<\"0\"\>", {0.54422380740598, 0.46984736945791095}], 
         ArrowBox[{{0., 0.4135773316641314}, {0.11495580635086149`, 
          0.45381040241743525`}, {0.14426414018258044`, 0.4632832537985109}, {
          0.17399401603037232`, 0.4713360686699898}, {0.20407667410041788`, 
          0.47795022233619333`}, {0.23444253867780251`, 0.4831104174630624}, {
          0.26502137904248657`, 0.4868047194581083}, {0.2957424719001827, 
          0.489024584072953}, {0.3265347649524687, 0.4897648771646219}, {
          0.761913300972594, 0.4897599460939131}, {0.7927055772479514, 
          0.4890189554991732}, {0.8234266198136639, 0.4867983949944552}, {
          0.8540053764876253, 0.4831034003322003}, {0.8843711241691098, 
          0.4779425173627998}, {0.9144536324084366, 0.47132768226959715`}, {
          0.9441833258372223, 0.463274193962668}, {0.9734914450835498, 
          0.4538006786952248}, {1.0884463400503142`, 0.4135650039873594}}]}, 
        {Hue[1, 1, 0.7], Opacity[1], 
         InsetBox["\<\"1\"\>", {0.5442225326443341, 0.35729496619358003}], 
         ArrowBox[{{1.0884463400503142`, 0.4135650039873594}, {
          0.9734905336994528, 0.37333193323405567`}, {0.9441821998677339, 
          0.3638590818529801}, {0.914452324019942, 0.3558062669815012}, {
          0.8843696659498965, 0.34919211331529765`}, {0.8540038013725118, 
          0.3440319181884286}, {0.8234249610078277, 0.34033761619338265`}, {
          0.7927038681501316, 0.33811775157853796`}, {0.7619115750978457, 
          0.33737745848686906`}, {0.3265330390777202, 0.3373823895575778}, {
          0.29574076280236283`, 0.3381233801523178}, {0.26501972023665044`, 
          0.34034394065703577`}, {0.23444096356268906`, 
          0.34403893531929064`}, {0.20407521588120453`, 0.3491998182886912}, {
          0.17399270764187777`, 0.3558146533818938}, {0.144263014213092, 
          0.363868141688823}, {0.11495489496676455`, 0.3733416569562662}, {0.,
           0.4135773316641314}}]}, {
         InsetBox["\<\"0\"\>", {1.5362789229123899, 0.6203464679338251}], 
         ArrowBox[{{1.0884463400503142`, 0.4135650039873594}, {
          1.9841115057744654`, 0.8271279318802908}}]}, {
         InsetBox["\<\"1\"\>", {1.9840908574937846, 0.4135639659401454}], 
         ArrowBox[{{1.9841115057744654`, 0.8271279318802908}, {
          1.984070209213104, 0.}}]}, {
         InsetBox["\<\"0\"\>", {1.536258274631709, 0.2067825019936797}], 
         ArrowBox[{{1.984070209213104, 0.}, {1.0884463400503142`, 
          0.4135650039873594}}]}}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[
        0.7]}], {DiskBox[{0., 0.4135773316641314}, 0.02248241640824508], 
         InsetBox["\<\"A\"\>", 
          Offset[{2, 2}, {0.02248241640824508, 0.43605974807237646}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{1.0884463400503142, 0.4135650039873594}, 
          0.02248241640824508], 
         InsetBox["\<\"B\"\>", 
          Offset[{2, 2}, {1.1109287564585593, 0.4360474203956045}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{1.9841115057744654, 0.8271279318802908}, 
          0.02248241640824508], 
         InsetBox["\<\"C\"\>", 
          Offset[{2, 2}, {2.0065939221827103, 0.8496103482885359}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{1.984070209213104, 0.}, 0.02248241640824508], 
         InsetBox["\<\"D\"\>", 
          Offset[{2, 2}, {2.006552625621349, 0.02248241640824508}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None]], "Output",
 CellChangeTimes->{
  3.6944973680314407`*^9, 3.6944975480711503`*^9, {3.694548105044136*^9, 
   3.6945481205663624`*^9}, 3.694548636179248*^9, 3.6945506206875753`*^9, 
   3.6945507031352434`*^9, 3.694550733742008*^9, 3.694551004837163*^9, 
   3.694551154188283*^9, 3.6945511924951086`*^9, 3.6945512904782085`*^9, 
   3.694552750767354*^9, 3.694553526160218*^9, 3.6945537854922686`*^9, 
   3.6945539970562916`*^9, 3.694554958221223*^9, 3.694555911465946*^9, 
   3.694556301952844*^9, 3.6945577188704777`*^9, 3.694558850415679*^9, 
   3.6945767501502132`*^9, 3.792376572421548*^9, 3.792624497505456*^9, 
   3.792625186886201*^9, 3.792625575703867*^9, 3.792625718750736*^9, 
   3.792625768988668*^9, 3.792626600812413*^9, 3.792626704443162*^9, 
   3.792628716514635*^9, 3.792628801917672*^9, 3.792628914897921*^9, 
   3.792629015691243*^9},
 CellLabel->
  "Out[1937]=",ExpressionUUID->"a08a2d5a-8174-4ae8-9b31-d0a4aa7480b4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Do a random walk on the graph with n steps starting from some vertex\
\>", "Subsection",
 CellChangeTimes->{
  3.7926267332450314`*^9},ExpressionUUID->"1b44ce4a-bcde-4731-aa05-\
ed1b69471b14"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", " ", "=", " ", "40"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"init", " ", "=", " ", "\"\<A\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"curVertex", " ", "=", " ", "init"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pathSeq", " ", "=", " ", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pathVertexList", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pathEdgeList", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"machine", " ", "=", " ", "machine"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"edge", ",", "edgeLabel"}], "}"}], "=", 
        RowBox[{"RandomChoice", "[", "\[IndentingNewLine]", 
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{"edgeList", ",", "labelList"}], "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"curVertex", "\[DirectedEdge]", "vf_"}], ",", "_"}], 
            "}"}]}], "]"}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"newVertex", " ", "=", " ", 
        RowBox[{"edge", "/.", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"a_", "\[DirectedEdge]", "b_"}], ")"}], "\[Rule]", " ", 
          "b"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pathSeq", " ", "=", " ", 
        RowBox[{"pathSeq", " ", "<>", " ", "edgeLabel"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pathVertexList", " ", "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{"pathVertexList", ",", "newVertex"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pathEdgeList", " ", "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{"pathEdgeList", ",", "edge"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"curVertex", " ", "=", " ", "newVertex"}], ";"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}], "\[IndentingNewLine]", "pathSeq", "\[IndentingNewLine]", 
 RowBox[{"HighlightGraph", "[", 
  RowBox[{"machine", ",", "pathEdgeList"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6945506294204493`*^9, 3.694550643725624*^9}, {
   3.6945516957142143`*^9, 3.694551781434866*^9}, {3.694552181047259*^9, 
   3.6945522361720285`*^9}, {3.694552404810261*^9, 3.6945524752684383`*^9}, {
   3.6945525067278056`*^9, 3.694552588110955*^9}, {3.694552650468704*^9, 
   3.694552684978229*^9}, {3.694552729203693*^9, 3.6945527672030544`*^9}, {
   3.694552804472192*^9, 3.6945528186552916`*^9}, {3.6945529086326795`*^9, 
   3.6945529088128347`*^9}, 3.6945529493866715`*^9, {3.6945530264159403`*^9, 
   3.694553026686104*^9}, {3.694554028553076*^9, 3.694554028656146*^9}, {
   3.6945546066694345`*^9, 3.694554647817889*^9}, {3.6945548797207804`*^9, 
   3.6945548802621374`*^9}, {3.6945558369494023`*^9, 3.694555837224599*^9}, {
   3.6945584626231427`*^9, 3.694558468625929*^9}, {3.792624715651742*^9, 
   3.792624748803846*^9}, 3.792624880631793*^9, {3.792624995647871*^9, 
   3.792625079729258*^9}, {3.792625229717222*^9, 3.7926253139948397`*^9}, {
   3.7926255289420977`*^9, 3.792625531186307*^9}, {3.792626732533536*^9, 
   3.792626738364924*^9}},
 CellLabel->
  "In[2026]:=",ExpressionUUID->"10f0e775-cd01-42f7-bbcf-6cf504d95298"],

Cell[BoxData["\<\"1010101011101010101010101110111011101010\"\>"], "Output",
 CellChangeTimes->{{3.6945524698775835`*^9, 3.69455249882018*^9}, {
   3.69455254270968*^9, 3.6945525526057177`*^9}, 3.694552589434908*^9, {
   3.694552671505635*^9, 3.694552685224391*^9}, {3.694552740901349*^9, 
   3.694552743116927*^9}, 3.694552776046977*^9, 3.694552820668723*^9, 
   3.694552909677421*^9, 3.694552950097165*^9, 3.69455302771585*^9, {
   3.6945530757988644`*^9, 3.694553078703611*^9}, 3.694553270451046*^9, 
   3.6945533980433607`*^9, {3.6945537881231537`*^9, 3.6945538021511307`*^9}, 
   3.6945539795728683`*^9, 3.6945540294156876`*^9, {3.6945546242364426`*^9, 
   3.6945546496391683`*^9}, {3.694554695835648*^9, 3.6945547150141087`*^9}, 
   3.6945547794178476`*^9, {3.694554880552382*^9, 3.6945549005862837`*^9}, 
   3.694554961336972*^9, 3.694555024967521*^9, 3.6945551607847605`*^9, {
   3.6945558235214767`*^9, 3.694555837518808*^9}, 3.694555906068114*^9, 
   3.6945563045537043`*^9, {3.6945568792568026`*^9, 3.6945568934278126`*^9}, 
   3.694557393447158*^9, 3.694557555837427*^9, 3.6945577258164043`*^9, {
   3.694557805229083*^9, 3.6945578235748053`*^9}, 3.6945578859423895`*^9, 
   3.694557918937181*^9, 3.694557953513511*^9, 3.6945580181102114`*^9, 
   3.694558048454262*^9, {3.694558091524322*^9, 3.694558119764906*^9}, 
   3.694558222962841*^9, 3.69455828639997*^9, {3.69455833972192*^9, 
   3.694558341696807*^9}, 3.6945584695385494`*^9, 3.694558514278527*^9, 
   3.694558562695451*^9, 3.6945767529130096`*^9, 3.6945775591410275`*^9, 
   3.694577596123268*^9, 3.792624509253046*^9, {3.792625292988432*^9, 
   3.792625314750038*^9}, 3.792625531531886*^9, 3.792625622626512*^9, 
   3.7926266271023407`*^9, 3.792626708198037*^9, 3.7926267438899527`*^9, 
   3.7926287282398252`*^9, 3.792628805978047*^9, 3.792628928451816*^9, 
   3.792629019974762*^9, 3.792629152657248*^9},
 CellLabel->
  "Out[2033]=",ExpressionUUID->"bfd0412f-cf9c-4197-a7a8-ab6be3adbdaf"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{
      "A", "C", "B", "D", "E", "F", "G", "H", "I"}, {{{1, 2}, {3, 4}, {2, 
       1}, {2, 3}, {4, 5}, {5, 6}, {6, 3}, {6, 3}, {7, 4}, {7, 5}, {8, 1}, {8,
        9}, {9, 1}, {9, 7}}, Null}, {
      EdgeShapeFunction -> {$CellContext`EdgeLabeler}, 
       VertexLabels -> {"Name"}, GraphHighlight -> {
         DirectedEdge["F", "B"], 
         DirectedEdge["D", "E"], 
         DirectedEdge["E", "F"], 
         DirectedEdge["A", "C"], 
         DirectedEdge["C", "B"], 
         DirectedEdge["C", "A"], 
         DirectedEdge["B", "D"]}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
        {Hue[1, 1, 0.7], Opacity[1], 
         InsetBox["\<\"1\"\>", {1.0671409141040828, 1.511869006097567}], 
         ArrowBox[{{0.6266988521174433, 1.1584173894802925`}, {
          0.7038642522357832, 1.2576588256704826`}, {0.723977075770095, 
          1.2822802601714958`}, {0.7452503865748359, 1.3059062406763333`}, {
          0.7676349833525533, 1.3284821245905691`}, {0.7910790946035273, 
          1.3499556980021374`}, {0.815528498363826, 1.3702772964426133`}, {
          0.8409266476108467, 1.3893999197520897`}, {0.8672148010462881, 
          1.4072793407819983`}, {1.2447706335848454`, 1.650998914925275}, {
          1.2718879914926458`, 1.6675937818277338`}, {1.2997718363576627`, 
          1.6828657136948462`}, {1.3283576779198758`, 1.6967793893267604`}, {
          1.3575794023286236`, 1.709302628923176}, {1.3873694250519137`, 
          1.72040646850937}, {1.4176588471871465`, 1.730065226924598}, {
          1.448377614811743, 1.7382565652179478`}, {1.570588433463837, 
          1.767716324838485}}]}, 
        {Hue[1, 1, 0.7], Opacity[1], 
         InsetBox["\<\"0\"\>", {1.1301463714771975, 1.4142647082212105}], 
         ArrowBox[{{1.570588433463837, 1.767716324838485}, {
          1.4934230333454972`, 1.6684748886482952`}, {1.4733102098111854`, 
          1.643853454147282}, {1.4520368990064447`, 1.6202274736424447`}, {
          1.429652302228727, 1.5976515897282089`}, {1.406208190977753, 
          1.5761780163166406`}, {1.3817587872174544`, 1.555856417876165}, {
          1.3563606379704338`, 1.5367337945666883`}, {1.330072484534992, 
          1.5188543735367799`}, {0.952516651996435, 1.275134799393503}, {
          0.9253992940886346, 1.2585399324910442`}, {0.8975154492236177, 
          1.2432680006239318`}, {0.8689296076614046, 1.2293543249920176`}, {
          0.8397078832526567, 1.216831085395602}, {0.8099178605293667, 
          1.205727245809408}, {0.779628438394134, 1.19606848739418}, {
          0.7489096707695375, 1.1878771491008302`}, {0.6266988521174433, 
          1.1584173894802925`}}]}, 
        {Hue[1, 1, 0.7], Opacity[1], 
         InsetBox["\<\"1\"\>", {2.133916640214388, 1.6334888713212428}], 
         ArrowBox[{{1.570588433463837, 1.767716324838485}, {
          2.6972448469649386`, 1.4992614178040005`}}]}, 
        {Hue[1, 1, 0.7], Opacity[1], 
         InsetBox["\<\"1\"\>", {2.692425514878388, 1.0428849003871217}], 
         ArrowBox[{{2.6972448469649386`, 1.4992614178040005`}, {
          2.687606182791838, 0.586508382970243}}]}, 
        {Hue[1, 1, 0.7], Opacity[1], 
         InsetBox["\<\"0\"\>", {2.9235735015348956, 0.3615802980654659}], 
         ArrowBox[{{2.687606182791838, 0.586508382970243}, {3.159540820277954,
           0.13665221316068876`}}]}, 
        {Hue[1, 1, 0.7], Opacity[1], 
         InsetBox["\<\"1\"\>", {3.3787824311081645, 0.5773348037061952}], 
         ArrowBox[{{3.159540820277954, 0.13665221316068876`}, {
          3.5980240419383747`, 1.0180173942517017`}}]}, 
        {Hue[1, 1, 0.7], Opacity[1], 
         InsetBox["\<\"0\"\>", {3.122752569519309, 1.2120662037145045}], 
         ArrowBox[{{3.5980240419383747`, 1.0180173942517017`}, {
          3.485099835094496, 1.0355463149704884`}, {3.456656399320433, 
          1.0406647688704778`}, {3.4284919401107494`, 1.0471448033137238`}, {
          3.4006715967353904`, 1.054971431159529}, {3.3732597125869854`, 
          1.0641265508416529`}, {3.3463196863662854`, 1.0745889882339417`}, {
          3.319913825452503, 1.08633454562223}, {3.2941032017976823`, 
          1.099336057669251}, {2.9337915238083085`, 1.2918336670901702`}, {
          2.9086358326890114`, 1.3060610636640377`}, {2.884193254642001, 
          1.3214814393849919`}, {2.8605203209032473`, 1.3380591297295534`}, {
          2.837671782661464, 1.3557557935160802`}, {2.8157004844285707`, 
          1.374530501580943}, {2.7946572418199476`, 1.3943398314402349`}, {
          2.774590724027168, 1.4151379677180764`}, {2.6972448469649386`, 
          1.4992614178040005`}}]}, 
        {Hue[1, 1, 0.7], Opacity[1], 
         InsetBox["\<\"0\"\>", {3.172516319384005, 1.305212608341198}], 
         ArrowBox[{{3.5980240419383747`, 1.0180173942517017`}, {
          3.5206781648761454`, 1.1021408443376264`}, {3.500611647083366, 
          1.1229389806154677`}, {3.479568404474743, 1.1427483104747596`}, {
          3.4575971062418493`, 1.1615230185396224`}, {3.434748568000066, 
          1.1792196823261492`}, {3.4110756342613127`, 1.1957973726707107`}, {
          3.386633056214302, 1.2112177483916646`}, {3.3614773650950047`, 
          1.2254451449655321`}, {3.001165687105631, 1.4179427543864516`}, {
          2.9753550634508104`, 1.4309442664334724`}, {2.9489492025370283`, 
          1.4426898238217607`}, {2.922009176316328, 1.4531522612140497`}, {
          2.894597292167923, 1.4623073808961733`}, {2.8667769487925643`, 
          1.4701340087419785`}, {2.838612489582881, 1.4766140431852248`}, {
          2.810169053808817, 1.481732497085214}, {2.6972448469649386`, 
          1.4992614178040005`}}]}, {
         InsetBox["\<\"1\"\>", {2.3817987530493827, 0.2932541914851215}], 
         ArrowBox[{{2.075991323306927, 0.}, {2.687606182791838, 
          0.586508382970243}}]}, {
         InsetBox["\<\"0\"\>", {2.6177660717924405, 0.06832610658034438}], 
         ArrowBox[{{2.075991323306927, 0.}, {3.159540820277954, 
          0.13665221316068876`}}]}, {
         InsetBox["\<\"0\"\>", {0.3133494260587216, 0.8608337688302546}], 
         ArrowBox[{{0., 0.5632501481802168}, {0.6266988521174433, 
          1.1584173894802925`}}]}, {
         InsetBox["\<\"1\"\>", {0.4357222976259578, 0.420055072168974}], 
         ArrowBox[{{0., 0.5632501481802168}, {0.8714445952519156, 
          0.27685999615773116`}}]}, {
         InsetBox["\<\"0\"\>", {0.7490717236846794, 0.7176386928190118}], 
         ArrowBox[{{0.8714445952519156, 0.27685999615773116`}, {
          0.6266988521174433, 1.1584173894802925`}}]}, {
         InsetBox["\<\"1\"\>", {1.4737179592794214, 0.13842999807886558}], 
         ArrowBox[{{0.8714445952519156, 0.27685999615773116`}, {
          2.075991323306927, 0.}}]}}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[
        0.7]}], {
         DiskBox[{0.6266988521174433, 1.1584173894802925}, 
          0.034379857771553585], 
         InsetBox["\<\"A\"\>", 
          Offset[{2, 2}, {0.6610787098889969, 1.192797247251846}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{1.570588433463837, 1.767716324838485}, 
          0.034379857771553585], 
         InsetBox["\<\"C\"\>", 
          Offset[{2, 2}, {1.6049682912353904, 1.8020961826100386}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{2.6972448469649386, 1.4992614178040005}, 
          0.034379857771553585], 
         InsetBox["\<\"B\"\>", 
          Offset[{2, 2}, {2.7316247047364923, 1.533641275575554}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{2.687606182791838, 0.586508382970243}, 
          0.034379857771553585], 
         InsetBox["\<\"D\"\>", 
          Offset[{2, 2}, {2.7219860405633916, 0.6208882407417966}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{3.159540820277954, 0.13665221316068876}, 
          0.034379857771553585], 
         InsetBox["\<\"E\"\>", 
          Offset[{2, 2}, {3.1939206780495075, 0.17103207093224235}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{3.5980240419383747, 1.0180173942517017}, 
          0.034379857771553585], 
         InsetBox["\<\"F\"\>", 
          Offset[{2, 2}, {3.6324038997099284, 1.0523972520232552}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{2.075991323306927, 0.}, 0.034379857771553585], 
         InsetBox["\<\"G\"\>", 
          Offset[{2, 2}, {2.110371181078481, 0.034379857771553585}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{0., 0.5632501481802168}, 0.034379857771553585], 
         InsetBox["\<\"H\"\>", 
          Offset[{2, 2}, {0.034379857771553585, 0.5976300059517704}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{0.8714445952519156, 0.27685999615773116}, 
          0.034379857771553585], 
         InsetBox["\<\"I\"\>", 
          Offset[{2, 2}, {0.9058244530234693, 0.31123985392928477}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None,
  ImageSize->{452., Automatic}]], "Output",
 CellChangeTimes->{{3.6945524698775835`*^9, 3.69455249882018*^9}, {
   3.69455254270968*^9, 3.6945525526057177`*^9}, 3.694552589434908*^9, {
   3.694552671505635*^9, 3.694552685224391*^9}, {3.694552740901349*^9, 
   3.694552743116927*^9}, 3.694552776046977*^9, 3.694552820668723*^9, 
   3.694552909677421*^9, 3.694552950097165*^9, 3.69455302771585*^9, {
   3.6945530757988644`*^9, 3.694553078703611*^9}, 3.694553270451046*^9, 
   3.6945533980433607`*^9, {3.6945537881231537`*^9, 3.6945538021511307`*^9}, 
   3.6945539795728683`*^9, 3.6945540294156876`*^9, {3.6945546242364426`*^9, 
   3.6945546496391683`*^9}, {3.694554695835648*^9, 3.6945547150141087`*^9}, 
   3.6945547794178476`*^9, {3.694554880552382*^9, 3.6945549005862837`*^9}, 
   3.694554961336972*^9, 3.694555024967521*^9, 3.6945551607847605`*^9, {
   3.6945558235214767`*^9, 3.694555837518808*^9}, 3.694555906068114*^9, 
   3.6945563045537043`*^9, {3.6945568792568026`*^9, 3.6945568934278126`*^9}, 
   3.694557393447158*^9, 3.694557555837427*^9, 3.6945577258164043`*^9, {
   3.694557805229083*^9, 3.6945578235748053`*^9}, 3.6945578859423895`*^9, 
   3.694557918937181*^9, 3.694557953513511*^9, 3.6945580181102114`*^9, 
   3.694558048454262*^9, {3.694558091524322*^9, 3.694558119764906*^9}, 
   3.694558222962841*^9, 3.69455828639997*^9, {3.69455833972192*^9, 
   3.694558341696807*^9}, 3.6945584695385494`*^9, 3.694558514278527*^9, 
   3.694558562695451*^9, 3.6945767529130096`*^9, 3.6945775591410275`*^9, 
   3.694577596123268*^9, 3.792624509253046*^9, {3.792625292988432*^9, 
   3.792625314750038*^9}, 3.792625531531886*^9, 3.792625622626512*^9, 
   3.7926266271023407`*^9, 3.792626708198037*^9, 3.7926267438899527`*^9, 
   3.7926287282398252`*^9, 3.792628805978047*^9, 3.792628928451816*^9, 
   3.792629019974762*^9, 3.792629152714445*^9},
 CellLabel->
  "Out[2034]=",ExpressionUUID->"8129a6e8-7b8b-43ae-a284-c9c7958bcd4d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Animate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"HighlightGraph", "[", 
    RowBox[{"machine", ",", 
     RowBox[{
     "pathEdgeList", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}],
     "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "pathEdgeList", "]"}], ",", "1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6945531755296874`*^9, 3.6945532296245375`*^9}},
 CellLabel->
  "In[2038]:=",ExpressionUUID->"def38845-2108-4cff-ab94-1cfa572fd2fa"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`i$$ = 28, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`i$$], 1, 40, 1}}, Typeset`size$$ = {
    396., {104., 109.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`i$432145$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`i$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`i$$, $CellContext`i$432145$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      HighlightGraph[$CellContext`machine, 
        Part[$CellContext`pathEdgeList, $CellContext`i$$]], 
      "Specifications" :> {{$CellContext`i$$, 1, 40, 1, 
         AppearanceElements -> {
          "ProgressSlider", "PlayPauseButton", "FasterSlowerButtons", 
           "DirectionButton"}}}, 
      "Options" :> {
       ControlType -> Animator, AppearanceElements -> None, DefaultBaseStyle -> 
        "Animate", DefaultLabelStyle -> "AnimateLabel", SynchronousUpdating -> 
        True, ShrinkingDelay -> 10.}, "DefaultOptions" :> {}],
     ImageSizeCache->{445., {144., 150.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Animate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.7926291892256327`*^9, 3.792629249317191*^9},
 CellLabel->
  "Out[2038]=",ExpressionUUID->"b694a7b3-d4bb-402e-bc17-01f3460e1f48"]
}, Open  ]],

Cell["\<\
Delete edges from graph  to remove initial condition states (unfinished). \
Need to differentiate multi-edges by label, and delete orphan vertices\
\>", "Text",
 CellChangeTimes->{{3.79262854908041*^9, 3.792628583591476*^9}, {
  3.792628649809289*^9, 
  3.792628678820442*^9}},ExpressionUUID->"c49c40b1-d054-48c9-8c8e-\
0c4816cdc9c5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Delete", " ", "vertices", " ", "from", " ", "graph"}], ",", " ", 
    RowBox[{
     RowBox[{"e", ".", "g", ".", " ", "to"}], " ", "remove", " ", "initial", 
     " ", "condition", " ", "states"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"minusInits", "=", 
   RowBox[{"EdgeDelete", "[", 
    RowBox[{"machine", ",", 
     RowBox[{"Complement", "[", 
      RowBox[{"edgeList", ",", 
       RowBox[{"Union", "@@", 
        RowBox[{"FindCycle", "[", 
         RowBox[{"machine", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"Length", "[", "edgeList", "]"}]}], "}"}]}], "]"}]}]}], 
      "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6945541428661156`*^9, 3.6945541501598883`*^9}, {
  3.6945541815362277`*^9, 3.6945542179070916`*^9}, {3.694554274543703*^9, 
  3.694554398695135*^9}, {3.694554632038993*^9, 3.6945546345667896`*^9}, {
  3.694554684465114*^9, 3.6945547041009502`*^9}, {3.69455476067003*^9, 
  3.694554845309627*^9}, {3.6945588752723985`*^9, 3.694558896054365*^9}, {
  3.792626848660418*^9, 3.7926268794819603`*^9}, {3.792628608459219*^9, 
  3.792628632118124*^9}},
 CellLabel->
  "In[2037]:=",ExpressionUUID->"8b03be40-f77c-4450-8c5d-c006aa95d5dd"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{
      "A", "C", "B", "D", "E", "F", "G", "H", "I"}, {{{1, 2}, {2, 1}, {6, 3}},
        Null}, {
      EdgeShapeFunction -> {$CellContext`EdgeLabeler}, 
       VertexLabels -> {"Name"}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[
        0.7], {InsetBox["\<\"1\"\>", \
{0.5357242857142855, -0.08742752505777424}], 
         ArrowBox[{{1.0357242857142857`, -0.03572428571428572}, {
          0.9301101213508874, -0.07268924324147513}, {
          0.903183459502157, -0.0813926427345742}, {
          0.8758694950517693, -0.08879140121524648}, {
          0.8482314002300295, -0.09486840670124713}, {
          0.8203330969218197, -0.09960960418452974}, {
          0.792239108826909, -0.10300402813792336`}, {
          0.7640144122283754, -0.10504382787640082`}, {
          0.7357242857142854, -0.10572428571428577`}, {
          0.33572428571428564`, -0.10572428571428577`}, {
          0.3074341592001956, -0.10504382787640082`}, {
          0.2792094626016622, -0.10300402813792336`}, {
          0.2511154745067514, -0.09960960418452974}, {
          0.22321717119854156`, -0.09486840670124702}, {
          0.19557907637680183`, -0.08879140121524637}, {
          0.1682651119264142, -0.08139264273457408}, {
          0.14133845007768361`, -0.07268924324147502}, {
          0.03572428571428565, -0.035724285714285715`}}]}, {
         InsetBox["\<\"0\"\>", {0.5357242857142859, 0.01597895362920277}], 
         ArrowBox[{{0.03572428571428565, -0.035724285714285715`}, {
          0.14133845007768395`, 0.0012406718129036598`}, {0.1682651119264145, 
          0.009944071306002722}, {0.19557907637680214`, 
          0.017342829786675007`}, {0.2232171711985419, 0.02341983527267566}, {
          0.25111547450675176`, 0.02816103275595827}, {0.27920946260166246`, 
          0.03155545670935189}, {0.30743415920019596`, 0.03359525644782935}, {
          0.335724285714286, 0.0342757142857143}, {0.7357242857142857, 
          0.0342757142857143}, {0.7640144122283758, 0.03359525644782935}, {
          0.7922391088269093, 0.03155545670935189}, {0.82033309692182, 
          0.02816103275595827}, {0.8482314002300299, 0.02341983527267555}, {
          0.8758694950517696, 0.017342829786674896`}, {0.9031834595021573, 
          0.009944071306002611}, {0.9301101213508878, 
          0.0012406718129035488`}, {
          1.0357242857142857`, -0.03572428571428572}}]}, {
         InsetBox["\<\"0\"\>", {0.5357242857142857, -0.10717285714285717}], 
         ArrowBox[{{0.03572428571428565, -0.10717285714285717`}, {
          1.0357242857142857`, -0.10717285714285717`}}]}}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[
        0.7]}], {DiskBox[{1.0357242857142857, -0.03572428571428572}, 0.01273],
          InsetBox["\<\"A\"\>", 
          Offset[{2, 2}, {1.0484542857142856, -0.022994285714285724}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{0.03572428571428565, -0.035724285714285715}, 0.01273], 
         InsetBox["\<\"C\"\>", 
          Offset[{2, 2}, {0.04845428571428565, -0.022994285714285717}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{1.0357242857142857, -0.10717285714285717}, 0.01273], 
         InsetBox["\<\"B\"\>", 
          Offset[{2, 2}, {1.0484542857142856, -0.09444285714285716}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{0.035724285714285715, -0.1786214285714286}, 0.01273], 
         InsetBox["\<\"D\"\>", 
          Offset[{2, 2}, {0.048454285714285714, -0.1658914285714286}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{0.25001399999999996, -0.1786214285714286}, 0.01273], 
         InsetBox["\<\"E\"\>", 
          Offset[{2, 2}, {0.262744, -0.1658914285714286}], ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{0.03572428571428565, -0.10717285714285717}, 0.01273], 
         InsetBox["\<\"F\"\>", 
          Offset[{2, 2}, {0.04845428571428565, -0.09444285714285716}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{0.4643037142857142, -0.1786214285714286}, 0.01273], 
         InsetBox["\<\"G\"\>", 
          Offset[{2, 2}, {0.4770337142857142, -0.1658914285714286}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{0.6785934285714285, -0.1786214285714286}, 0.01273], 
         InsetBox["\<\"H\"\>", 
          Offset[{2, 2}, {0.6913234285714285, -0.1658914285714286}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{0.8928831428571428, -0.1786214285714286}, 0.01273], 
         InsetBox["\<\"I\"\>", 
          Offset[{2, 2}, {0.9056131428571428, -0.1658914285714286}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None]], "Output",
 CellChangeTimes->{
  3.694554845730919*^9, {3.7926286090601997`*^9, 3.792628632395113*^9}, 
   3.79262882043487*^9, 3.792628936836193*^9, 3.792629212676659*^9},
 CellLabel->
  "Out[2037]=",ExpressionUUID->"5b40934e-f308-4614-b0a7-badcbbf36235"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{771, 855},
WindowMargins->{{8, Automatic}, {Automatic, 31}},
Magnification:>1.1 Inherited,
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 242, 6, 39, "Text",ExpressionUUID->"ec887f50-17c0-4051-bd92-60c2b254ec9a"],
Cell[803, 28, 1628, 41, 173, "Input",ExpressionUUID->"fa58c9c7-de43-4f06-b7bd-688c413392c8"],
Cell[CellGroupData[{
Cell[2456, 73, 165, 3, 60, "Subsection",ExpressionUUID->"9361d4af-57fc-4801-8014-e4ee4f6a5452"],
Cell[2624, 78, 2222, 37, 34, "Input",ExpressionUUID->"29f80a4b-8587-4ea5-be22-cc8d2fb1c6b4"],
Cell[4849, 117, 1824, 45, 150, "Input",ExpressionUUID->"87404ed6-3725-4748-a9b3-0e9e2b931436"],
Cell[6676, 164, 196, 3, 39, "Text",ExpressionUUID->"9ad225d1-6d6d-4765-a5ed-3c06e3993a61"],
Cell[6875, 169, 1268, 34, 127, "Input",ExpressionUUID->"3a334192-53f9-4bb6-8397-69fea157c317"],
Cell[8146, 205, 192, 3, 39, "Text",ExpressionUUID->"bf9849c9-f9a3-4c12-ad78-96beb2cf60a9"],
Cell[CellGroupData[{
Cell[8363, 212, 1079, 24, 104, "Input",ExpressionUUID->"f520b915-f165-470e-9e17-5d29760f280f"],
Cell[9445, 238, 381, 6, 38, "Output",ExpressionUUID->"22faf63c-a317-4e62-bd50-5a2e8570c8be"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[9875, 250, 172, 3, 60, "Subsection",ExpressionUUID->"6c196596-01d6-4f3b-b21e-845e4b115ae3"],
Cell[CellGroupData[{
Cell[10072, 257, 8048, 150, 334, "Input",ExpressionUUID->"9d0133f8-f8c2-4496-a150-32373d116d08"],
Cell[18123, 409, 2717, 38, 25, "Print",ExpressionUUID->"b6524b76-7524-4992-93cf-9df7390521e2"]
}, Open  ]],
Cell[20855, 450, 180, 3, 39, "Text",ExpressionUUID->"f1bfdbe7-9f5f-4f81-bcfd-66551a51444a"],
Cell[CellGroupData[{
Cell[21060, 457, 14690, 303, 1300, "Input",ExpressionUUID->"a60a45ba-1fd1-4a51-abfb-8571a225e729"],
Cell[35753, 762, 6489, 122, 448, "Output",ExpressionUUID->"cbf9b58f-7c0c-4998-b116-400a7309ab0c"],
Cell[42245, 886, 6604, 101, 42, "Print",ExpressionUUID->"fe9e373e-4cdd-41e5-86d2-8446cba45594"]
}, Open  ]],
Cell[48864, 990, 156, 3, 34, "Input",ExpressionUUID->"3ecf4ad3-a0d2-4493-9a21-a8d56397a3fd"],
Cell[CellGroupData[{
Cell[49045, 997, 639, 11, 34, "Input",ExpressionUUID->"504d4cd3-564d-41fc-8180-d38c52488b44"],
Cell[49687, 1010, 5985, 106, 174, "Output",ExpressionUUID->"a08a2d5a-8174-4ae8-9b31-d0a4aa7480b4"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[55721, 1122, 202, 5, 60, "Subsection",ExpressionUUID->"1b44ce4a-bcde-4731-aa05-ed1b69471b14"],
Cell[CellGroupData[{
Cell[55948, 1131, 3641, 79, 472, "Input",ExpressionUUID->"10f0e775-cd01-42f7-bbcf-6cf504d95298"],
Cell[59592, 1212, 1962, 27, 38, "Output",ExpressionUUID->"bfd0412f-cf9c-4197-a7a8-ab6be3adbdaf"],
Cell[61557, 1241, 11449, 200, 283, "Output",ExpressionUUID->"8129a6e8-7b8b-43ae-a284-c9c7958bcd4d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73043, 1446, 544, 14, 58, "Input",ExpressionUUID->"def38845-2108-4cff-ab94-1cfa572fd2fa"],
Cell[73590, 1462, 2079, 42, 349, "Output",ExpressionUUID->"b694a7b3-d4bb-402e-bc17-01f3460e1f48"]
}, Open  ]],
Cell[75684, 1507, 344, 7, 65, "Text",ExpressionUUID->"c49c40b1-d054-48c9-8c8e-0c4816cdc9c5"],
Cell[CellGroupData[{
Cell[76053, 1518, 1269, 28, 104, "Input",ExpressionUUID->"8b03be40-f77c-4450-8c5d-c006aa95d5dd"],
Cell[77325, 1548, 5460, 104, 118, "Output",ExpressionUUID->"5b40934e-f308-4614-b0a7-badcbbf36235"]
}, Open  ]]
}, Open  ]]
}
]
*)

